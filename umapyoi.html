<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Chrono Genesis Betting Chronicle</title>
  <link rel="shortcut icon" type="image/x-icon" href="favicon.png?">
 <!-- 外部 CSS -->
  <link rel="stylesheet" href="style.css">
</head>
<body>
<h1 id="mainTitleZh">創世駒的賭馬啟示錄</h1>
<h1 id="mainTitleEn" style="display:none;">Chrono Genesis Betting Chronicle</h1>
<p id="sloganZh" class="small">你的個人賽馬預測與下注模擬器</p>
<p id="sloganEn" class="small" style="display:none;">Your personal horse racing prediction &amp; betting simulator</p>

<!-- 導覽列：左邊語言切換，右邊 PDF -->
<div class="navbar">
  <button id="langToggle" class="primary lang-toggle" type="button">中文 / EN</button>
  <a href="https://github.com/bext1998/bext1998.github.io/blob/main/how_to_bet_en.pdf" target="_blank" rel="noopener">
    <button class="secondary" type="button" id="howToBetBtn">如何下注說明（PDF）</button>
  </a>
</div>

<!-- 點數 & 券種命中率 -->
<div class="card">
  <div class="section-title"><h2 id="pointsSectionTitle">點數與命中率</h2></div>
  <div class="flex-row">
    <span id="pointsLabel">目前總點數：</span>
    <strong id="pointsDisplay">0</strong>
    <span class="small" id="pointsHint">
      （下注會扣點數，中獎按賽事管理區的賠率計算回收；點數可為負，不會自動重設）
    </span>
  </div>
  <div id="hitStatsContainer" class="small" style="margin-top:8px;"></div>
</div>

<!-- 建立新賽事 -->
<div class="card">
  <div class="section-title"><h2 id="createRaceTitle">建立新賽事</h2></div>

  <label>
    <span id="raceNameLabel">賽事名稱：</span>
    <input type="text" id="raceNameInput" placeholder="例：東京11R 天皇賞（秋） / Tokyo 11R Tenno Sho (Autumn)">
  </label>

  <label>
    <span id="raceDateLabel">賽事日期：</span>
    <input type="date" id="raceDateInput">
  </label>

  <!-- 競馬場 / 場地 / 場次 -->
  <div class="flex-row">
    <label>
      <span id="racecourseLabelSpan">競馬場：</span>
      <select id="racecourseSelect">
        <option value="">未選擇</option>
        <option value="SAPPORO">札幌</option>
        <option value="HAKODATE">函館</option>
        <option value="FUKUSHIMA">福島</option>
        <option value="NIIGATA">新潟</option>
        <option value="TOKYO">東京</option>
        <option value="NAKAYAMA">中山</option>
        <option value="CHUKYO">中京</option>
        <option value="KYOTO">京都</option>
        <option value="HANSHIN">阪神</option>
        <option value="KOKURA">小倉</option>
      </select>
    </label>

    <label>
      <span id="surfaceLabelSpan">場地：</span>
      <select id="surfaceSelect">
        <option value="">未選擇</option>
        <option value="TURF">草地 / Turf</option>
        <option value="DIRT">泥地 / Dirt</option>
      </select>
    </label>

    <label>
      <span id="raceNumberLabelSpan">場次：</span>
      <select id="raceNumberSelect">
        <option value="">未選擇</option>
        <option value="1">1R</option>
        <option value="2">2R</option>
        <option value="3">3R</option>
        <option value="4">4R</option>
        <option value="5">5R</option>
        <option value="6">6R</option>
        <option value="7">7R</option>
        <option value="8">8R</option>
        <option value="9">9R</option>
        <option value="10">10R</option>
        <option value="11">11R</option>
        <option value="12">12R</option>
      </select>
    </label>
  </div>

  <div class="flex-row">
    <label>
      <span id="runnerCountLabel">出賽頭數：</span>
      <input type="number" id="runnerCountInput" min="2" max="24" value="12">
    </label>
    <span class="small" id="placeRuleHint">
      複勝：5–7 頭 → 2 著內；8 頭以上 → 3 著內；4 頭以下理論上不賣複勝。
    </span>
  </div>

  <p id="optionsIntro" class="small">
    一個選項 = 一張馬券。券種請選擇 JRA 類型，賽馬背號/PP 用半形數字與 - 連接（例：13、6-7、6-7-13）。
  </p>

  <!-- 進階工具：可折疊（只有 BOX / Banker / Bracket 放在這裡） -->
  <div class="card" style="background:#f9fafb; margin-bottom:10px; padding:10px 12px;">
    <details>
      <summary>進階工具 / Advanced tools</summary>

      <!-- BOX 展開小工具 -->
      <div class="small" style="margin-top:8px;">
        <p>
          <strong id="boxHelperTitle">BOX 展開小工具</strong><br>
          <span id="boxHelperDesc">
            輸入賽馬背號 / PP（例如：<code>6 7 13 16</code>），選擇 BOX 券種，系統會自動產生所有組合並加入下方選項。
          </span>
        </p>
        <label class="small">
          <span id="boxNumbersLabel">賽馬背號 / PP：</span>
          <input type="text" id="boxNumbersInput" placeholder="例：6 7 13 16 / e.g. 6 7 13 16">
        </label>
        <br>
        <label class="small">
          <span id="boxModeLabel">BOX 券種：</span>
          <select id="boxModeSelect">
            <option value="QUINELLA">馬連 BOX（QUINELLA, 2頭組合）</option>
            <option value="TRIO">三連複 BOX（TRIO, 3頭組合）</option>
            <option value="TRIFECTA">三連單 BOX（TRIFECTA, 3頭排列）</option>
          </select>
        </label>
        <button class="secondary" type="button" onclick="expandBox()" id="boxExpandBtn">
          BOX 展開 → 加入選項
        </button>
      </div>

      <hr>

      <!-- Banker 小工具（軸馬） -->
      <div class="small">
        <p><strong id="bankerTitle">Banker 軸馬小工具</strong></p>

        <label>
          <span id="bankerModeLabel">券種：</span>
          <select id="bankerModeSelect">
            <option value="QUINELLA">馬連 Banker（QUINELLA）</option>
            <option value="TRIO">三連複 Banker（TRIO）</option>
            <option value="TRIFECTA">三連單 Banker（TRIFECTA，軸馬固定第1名）</option>
          </select>
        </label>
        <br>

        <label>
          <span id="bankerAxisLabel">軸馬號碼：</span>
          <input type="text" id="bankerAxisInput" placeholder="例：7 / e.g. 7">
        </label>
        <br>

        <label>
          <span id="bankerOthersLabel">其他馬號：</span>
          <input type="text" id="bankerOthersInput" placeholder="例：3 6 13 / e.g. 3 6 13">
        </label>
        <br>

        <button class="secondary" type="button"
                onclick="expandBanker()" id="bankerExpandBtn">
          Banker 展開 → 加入選項
        </button>
      </div>

      <hr>

      <!-- Bracket 小工具（枠連） -->
      <div class="small">
        <p><strong id="bracketTitle">Bracket（枠連）小工具</strong></p>

        <label>
          <span id="bracketInputLabel">枠番組合：</span>
          <input type="text" id="bracketInput" placeholder="例：1-3 或 1 3">
        </label>

        <button class="secondary" type="button"
                onclick="addBracketTicket()" id="bracketAddBtn">
          加入枠連馬券
        </button>

        <p class="small" id="bracketInfo">
          會建立券種：枠連（Bracket Quinella），名稱為枠番組合，例如 <code>1-3</code>。<br>
          中獎判定會依馬號推算枠番（簡化版）。
        </p>
      </div>

    </details>
  </div>

  <!-- 手動新增券種（★ 基本的選項列在這裡） -->
  <div id="optionsContainer"></div>
  <button class="secondary" type="button" onclick="addOptionRow()" id="addOptionBtn">
    新增馬券選項
  </button>
  <button class="primary" type="button" onclick="createRace()" id="createRaceBtn">
    建立比賽
  </button>
</div>


<!-- 賽事管理區 -->
<div class="card">
  <div class="section-title"><h2 id="raceManageTitle">賽事管理區（出賽頭數 / 賠率）</h2></div>
  <p class="small" id="raceManageHint">
    在這裡可以修改已建立賽事的賽事日期、出賽頭數、競馬場 / 場地 / 場次與各券種的賠率，並可直接追加馬券選項。下注區只能查看賠率，無法修改。
  </p>
  <div id="raceManageContainer"></div>
  <p class="small" id="noRaceManageMsg"></p>
</div>

<!-- 進行下注 -->
<div class="card">
  <div class="section-title"><h2 id="bettingTitle">進行下注</h2></div>
  <p class="small" id="bettingHint">
    選擇欲下注的券種，輸入點數即可。賠率請於上方「賽事管理區」設定 / 修改。
  </p>
  <div id="bettingContainer"></div>
  <p class="small" id="noBettingMsg"></p>
</div>

<!-- 賽事結算 -->
<div class="card">
  <div class="section-title"><h2 id="settleTitle">賽事結算（自動判斷中獎組合）</h2></div>
  <p class="small" id="settleHint">
    每個賽事請輸入實際前 3 著的賽馬背號 / PP（例如：<code>13 6 7</code>），系統會依券種自動判斷是否中獎並計算回收。
  </p>
  <div id="settleContainer"></div>
  <p class="small" id="noSettleMsg"></p>
</div>

<!-- 下注紀錄 -->
<div class="card">
  <div class="section-title"><h2 id="historyTitle">下注紀錄</h2></div>
  <div id="historyContainer"></div>
</div>

<!-- 系統操作 -->
<div class="card">
  <div class="section-title"><h2 id="systemTitle">系統操作</h2></div>
  <button class="danger" type="button" onclick="resetAll()" id="resetBtn">清空所有資料（不可復原）</button>
  <span class="small" id="resetHint">會清除所有賽事、下注紀錄與點數。</span>
</div>
<script src="app.js"></script>
</body>
</html>
